------------------------------------------------------------------------------------
      name:  <unnamed>
       log:  C:\git\artbin\examples\artbin_examples.log
  log type:  text
 opened on:  27 Jun 2022, 12:56:05

. 
. 
. which artbin
c:\ado\personal\a\artbin.ado
*!version 2.0.1 EMZ    09june2022 

. which art2bin
c:\ado\personal\a\art2bin.ado
*!version 1.01  09june2022

. 
. 
. 
. /***
> \subsection{Binary outcome and comparison with published sample size}
> We reproduce the sample size calculation in \citet{Pocock83} for a 2-arm superiori
> ty trial comparing the efficacy of therapeutic doses of anturan in patients after 
> a myocardial infarction with the placebo standard treatment.  The primary outcome 
> was death from any cause within one year of first treatment.  The control (placebo
> ) arm was expected to have a 10\% probability of death within one year and the ant
> uran treatment arm a 5\% probability, with the trial powered at 90\%.  The patient
>  outcome was binary; either failure (death in a year) or success (survival).  The 
> published sample size was 578 patients per arm (1156 patients in total).
> In the below \texttt{artbin} example we do not specify in the syntax whether the o
> utcome is favourable or unfavourable, rather we let the program infer it.  The aim
>  of a clinical trial is always to improve patient outcome, therefore as the experi
> mental arm anticipated probability ($\pi_2 = 0.05$) is $less$ $than$ the control a
> rm anticipated probability ($\pi_1 = 0.1$) then the outcome is inferred to be unfa
> vourable (i.e. the trial is aiming to $reduce$ the probability of the event occurr
> ing, in this case, death).
> ***/
. 
. 
. artbin, pr(0.1 0.05) alpha(0.05) power(0.9) wald

ART - ANALYSIS OF RESOURCES FOR TRIALS (binary version 2.0.1 09june2022)
------------------------------------------------------------------------------
A sample size program by Abdel Babiker, Patrick Royston, Friederike Barthel, 
Ella Marley-Zagar and Ian White
MRC Clinical Trials Unit at UCL, London WC1V 6LJ, UK.
------------------------------------------------------------------------------
Type of trial                          superiority
Number of groups                       2
Favourable/unfavourable outcome        unfavourable
                                       Inferred by the program
Allocation ratio                       equal group sizes
Statistical test assumed               unconditional comparison of 2
                                        binomial proportions
                                        using the wald test
Local or distant                       distant
Continuity correction                  no

Anticipated event probabilities        0.100  0.050 

Alpha                                  0.050 (two-sided)
                                       (taken as .025 one-sided)
Power (designed)                       0.900

Total sample size (calculated)         1156

Sample size per group (calculated)     578 578
Expected total number of events        86.70    
------------------------------------------------------------------------------

. local n=r(n)

. 
. 
. /***
> The \texttt{artbin} output table shows the trial set-up information including the 
> study design, statistical tests and methods used.  The hypothesis tests are shown 
> with the calculated sample size and events based on the selected power.  
> A total sample size of 1156 participants is required, as per the published sample 
> size given by Pocock.
> The same result is achieved by the code \texttt{artbin, pr(0.9 0.95) alpha(0.05) p
> ower(0.9) wald} assuming a favourable outcome (survival) instead.
> The Wald test is used instead of the default score test as Pocock used the sample 
> estimate in the method of estimating the variance of the difference in proportions
>  under the null hypothesis $H_{0}$.
> 
> \subsection{Binary outcome and comparison with \texttt{power}}
> We compare the output of \texttt{artbin} to Stata's \texttt{power} command, which 
> like \texttt{artbin} uses the score test as the default.
> ***/
. 
. 
. power twoproportions 0.1 0.05, alpha(0.05) power(0.9)

Performing iteration ...

Estimated sample sizes for a two-sample proportions test
Pearson's chi-squared test 
Ho: p2 = p1  versus  Ha: p2 != p1

Study parameters:

        alpha =    0.0500
        power =    0.9000
        delta =   -0.0500  (difference)
           p1 =    0.1000
           p2 =    0.0500

Estimated sample sizes:

            N =     1,164
  N per group =       582

. local npower=r(N)

. 
. artbin, pr(0.1 0.05) alpha(0.05) power(0.9)

ART - ANALYSIS OF RESOURCES FOR TRIALS (binary version 2.0.1 09june2022)
------------------------------------------------------------------------------
A sample size program by Abdel Babiker, Patrick Royston, Friederike Barthel, 
Ella Marley-Zagar and Ian White
MRC Clinical Trials Unit at UCL, London WC1V 6LJ, UK.
------------------------------------------------------------------------------
Type of trial                          superiority
Number of groups                       2
Favourable/unfavourable outcome        unfavourable
                                       Inferred by the program
Allocation ratio                       equal group sizes
Statistical test assumed               unconditional comparison of 2
                                        binomial proportions
                                        using the score test
Local or distant                       distant
Continuity correction                  no

Anticipated event probabilities        0.100  0.050 

Alpha                                  0.050 (two-sided)
                                       (taken as .025 one-sided)
Power (designed)                       0.900

Total sample size (calculated)         1164

Sample size per group (calculated)     582 582
Expected total number of events        87.30    
------------------------------------------------------------------------------

. local nartbin=r(n)

. 
. 
. /***
> Both give a total sample size of `nartbin'.
> 
> \subsection{One-sided non-inferiority trial}
> Next we show a one-sided non-inferiority trial with the 'onesided' option.  We ass
> ume a 90\% probability of survival in both the control and treatment arms, with th
> e treatment arm being no more than 5\% less effective than the control.
> ***/
. 
. artbin, pr(0.9 0.9) margin(-0.05) onesided

ART - ANALYSIS OF RESOURCES FOR TRIALS (binary version 2.0.1 09june2022)
------------------------------------------------------------------------------
A sample size program by Abdel Babiker, Patrick Royston, Friederike Barthel, 
Ella Marley-Zagar and Ian White
MRC Clinical Trials Unit at UCL, London WC1V 6LJ, UK.
------------------------------------------------------------------------------
Type of trial                          non-inferiority
Number of groups                       2
Favourable/unfavourable outcome        favourable
                                       Inferred by the program
Allocation ratio                       equal group sizes
Statistical test assumed               unconditional comparison of 2
                                        binomial proportions
                                        using the score test
Local or distant                       distant
Continuity correction                  no
Null hypothesis H0:                    H0: pi2 - pi1 <= -.05
Alternative hypothesis H1:             H1: pi2 - pi1 > -.05

Anticipated event probabilities        0.900  0.900 

Alpha                                  0.050 (one-sided)
Power (designed)                       0.800

Total sample size (calculated)         914

Sample size per group (calculated)     457 457
Expected total number of events        822.60   
------------------------------------------------------------------------------

. 
. 
. /***
> 
> A sample size of 457 is required in each group.
> 
> \subsection{Superiority trial with multiple arms}
> Next we demonstrate a superiority trial with more than 2 arms.  Instead of compari
> ng each of the treatment arms to the control group, \texttt{artbin} uses a global 
> test to assess if there is $any$ difference among the groups.
> ***/
. 
. 
. artbin, pr(0.1 0.2 0.3 0.4) alpha(0.1) power(0.9) 

ART - ANALYSIS OF RESOURCES FOR TRIALS (binary version 2.0.1 09june2022)
------------------------------------------------------------------------------
A sample size program by Abdel Babiker, Patrick Royston, Friederike Barthel, 
Ella Marley-Zagar and Ian White
MRC Clinical Trials Unit at UCL, London WC1V 6LJ, UK.
------------------------------------------------------------------------------
Type of trial                          superiority
Number of groups                       4
Favourable/unfavourable outcome        not determined
Allocation ratio                       equal group sizes
Statistical test assumed               unconditional comparison of 4
                                        binomial proportions
                                        using the score test
Local or distant                       distant
Continuity correction                  no

Anticipated event probabilities        0.100 0.200 0.300 0.400

Alpha                                  0.100 (two-sided)
Power (designed)                       0.900

Total sample size (calculated)         176

Sample size per group (calculated)     44 44 44 44
Expected total number of events        44.00    
------------------------------------------------------------------------------

. 
. 
. /***
> 
> A sample size of 44 is required in each of the four groups.
> 
> \subsection{Complex non-inferiority trial in a real-life setting} \label{sec:compl
> exNIexample}
> Finally, we demonstrate a more complex non-inferiority design from the STREAM tria
> l.  The need for the STREAM trial arose from the increase of multi-drug resistant 
> strains of Tuberculosis, especially in countries without robust health care system
> s unable to administer and follow up treatment over long periods of time.  The STR
> EAM trial evaluated a shorter more intensive treatment for multi-drug resistant Tu
> berculosis compared to the lengthier treatment recommended by the World Health Org
> anization. 
> The trial used an expected 0.7 probability on control ($\pi_1$) and 0.75 on treatm
> ent ($\pi_2$), hence it was assumed that 70\% in the long-regimen group and 75\% o
> f the participants in the short-regimen group would attain a favourable outcome.  
> A favourable outcome was defined as cultures negative for $Mycobacterium$ $tubercu
> losis$ at 132 weeks and at a previous occasion, with no intervening positive cultu
> re or previous unfavourable outcome \citep{Nunn2019}.  A 10 percentage-point non-i
> nferiority margin was considered to be an acceptable difference in efficacy, given
>  the shorter treatment duration ($m =$ -0.1 defined as $\pi_2$-$\pi_1$), with twic
> e as many patients in treatment compared to control.  The \texttt{wald} test was a
> pplied as it is often used in non-inferiority trials. 
> ***/
. 
. 
. artbin, pr(0.7 0.75) margin(-0.1) power(0.8) ar(1 2) wald ltfu(0.2)

ART - ANALYSIS OF RESOURCES FOR TRIALS (binary version 2.0.1 09june2022)
------------------------------------------------------------------------------
A sample size program by Abdel Babiker, Patrick Royston, Friederike Barthel, 
Ella Marley-Zagar and Ian White
MRC Clinical Trials Unit at UCL, London WC1V 6LJ, UK.
------------------------------------------------------------------------------
Type of trial                          non-inferiority
Number of groups                       2
Favourable/unfavourable outcome        favourable
                                       Inferred by the program
Allocation ratio                       1:2
Statistical test assumed               unconditional comparison of 2
                                        binomial proportions
                                        using the wald test
Local or distant                       distant
Continuity correction                  no
Null hypothesis H0:                    H0: pi2 - pi1 <= -.1
Alternative hypothesis H1:             H1: pi2 - pi1 > -.1

Anticipated event probabilities        0.700  0.750 

Alpha                                  0.050 (two-sided)
                                       (taken as .025 one-sided)
Power (designed)                       0.800

Loss to follow up assumed:             20 %

Total sample size (calculated)         399

Sample size per group (calculated)     133 266
Expected total number of events        292.60   
------------------------------------------------------------------------------

. local n=r(n)

. 
. /***
> The non-inferiority trial required a total sample size of 399 (133 in control, 266
>  in intervention), assuming 20\% of patients were not accessible in primary analys
> is.  When the STREAM trial concluded, it estimated that a shorter more intensive t
> reatment for multi-drug resistant Tuberculosis was only 1\% less effective than th
> e lengthier treatment recommended by the World Health Organization, and demonstrat
> ed significant evidence of non-inferiority.
> 
> 
> ***/
. 
. log close
      name:  <unnamed>
       log:  C:\git\artbin\examples\artbin_examples.log
  log type:  text
 closed on:  27 Jun 2022, 12:56:06
------------------------------------------------------------------------------------
